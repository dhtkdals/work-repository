import sqlite3
import requests
from bs4 import BeautifulSoup

# SQLite 데이터베이스 연결
conn = sqlite3.connect('news_articles.db')
cursor = conn.cursor()

# 테이블 생성
cursor.execute('''
    CREATE TABLE IF NOT EXISTS news_articles (
        id INTEGER PRIMARY KEY,
        title TEXT,
        content TEXT
    )
''')

# 뉴스 기사 수집 및 색인 함수
def index_news_article(url):
    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.text, 'html.parser')
        title = soup.find('h1').get_text()
        content = soup.find('div', class_='article-body').get_text()
        cursor.execute('INSERT INTO news_articles (title, content) VALUES (?, ?)', (title, content))
        conn.commit()
        print(f'뉴스 기사 색인 완료: {title}')
    except Exception as e:
        print(f'뉴스 기사 색인 중 오류 발생: {str(e)}')

# 메인 함수
def main():
    while True:
        news_url = input("뉴스 기사 URL을 입력하세요 (종료하려면 '종료' 입력): ")
        if news_url == '종료':
            break
        index_news_article(news_url)

# 뉴스 기사 검색 함수
def search_news_articles(query):
    cursor.execute("SELECT * FROM news_articles WHERE content LIKE ?", ('%' + query + '%',))
    results = cursor.fetchall()
    return results


if __name__ == "__main__":
    main()


